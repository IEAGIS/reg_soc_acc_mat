
# Multi Regional Input Output model

#### Note this is only a proof of concept data is totally made up


```python
import os
import pandas as pd
import numpy as np
import copy
#from openpyxl import load_workbook
    
cwd = os.getcwd()
cwd = os.chdir(r'C:\Users\jojoseph\Desktop\Python Models\Python\IO')

print (os.getcwd())
```

    C:\Users\jojoseph\Desktop\Python Models\Python\IO
    

### Load the input data
##### Input data located in 'reg_soc_acc_mat\data' It will need to be copied to your working directory


```python
#opening the social account matrix excel files from IMPLAN -(89 sectors summarized from study area data/study area explorer )
new_MRIO= 'new_MRIO.xlsx'# open file with social account matrices
reg_soc_acc_mat=pd.ExcelFile(new_MRIO)
print (reg_soc_acc_mat.sheet_names)

#region3=reg_soc_acc_mat.parse('region2')
```

    ['region0']
    

### Load aggregated sector names


```python
#sector_names = np.loadtxt('aggregated_sector_names.txt', usecols=1, delimiter="\'", dtype=str)[...,None]
sector_names = np.loadtxt('aggregated_sector_names.txt', usecols=1, delimiter="\'", dtype=str)

sector_names
```




    array(['Agriculture', 'Mining', 'Construction', 'Durable Goods MFG',
           'Nondurable Goods MFG', 'Trade, Transportaiton & Utilities',
           'Information', 'Finance, Insurance & Real Estate',
           'Professional & Business Services', 'Education & health Services',
           'Leisure & Hospitality', 'Other Services', 'Government',
           'Other Nonproducing Sectors'],
          dtype='<U33')



## Read in reference matrices excel sheet


```python
reference_matrices = 'reference_matrices.xlsx'
ref_mat=pd.ExcelFile(reference_matrices)
print (ref_mat.sheet_names)
```

    ['Sheet1', 'IndAggMat', 'ConvFact', 'MRSAM_mult']
    

### Multi Region SAM multiplier


```python
mrsam_mult_df = pd.read_excel(ref_mat,'MRSAM_mult', skiprows=2,  usecols = "C:UH")
mrsam_mult_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>PI3</th>
      <th>PI4</th>
      <th>PI5</th>
      <th>PI6</th>
      <th>HH1</th>
      <th>HH2</th>
      <th>HH3</th>
      <th>HH4</th>
      <th>HH5</th>
      <th>HH6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.115473</td>
      <td>0.007422</td>
      <td>0.002036</td>
      <td>0.003018</td>
      <td>0.233903</td>
      <td>0.001576</td>
      <td>0.026853</td>
      <td>0.000707</td>
      <td>0</td>
      <td>0.001407</td>
      <td>...</td>
      <td>0.000582</td>
      <td>0.000807</td>
      <td>0.000491</td>
      <td>2.962485e-04</td>
      <td>0.004782</td>
      <td>0.000882</td>
      <td>0.000604</td>
      <td>0.000838</td>
      <td>0.000510</td>
      <td>0.000308</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.082254</td>
      <td>1.050348</td>
      <td>0.000741</td>
      <td>0.023355</td>
      <td>0.017605</td>
      <td>0.057254</td>
      <td>0.014521</td>
      <td>0.015370</td>
      <td>0</td>
      <td>0.000346</td>
      <td>...</td>
      <td>0.000121</td>
      <td>0.000189</td>
      <td>0.000120</td>
      <td>6.409873e-05</td>
      <td>0.001122</td>
      <td>0.000252</td>
      <td>0.000126</td>
      <td>0.000197</td>
      <td>0.000124</td>
      <td>0.000067</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.023870</td>
      <td>0.016998</td>
      <td>1.002141</td>
      <td>0.001582</td>
      <td>0.005645</td>
      <td>0.011959</td>
      <td>0.075809</td>
      <td>0.005898</td>
      <td>0</td>
      <td>0.001944</td>
      <td>...</td>
      <td>0.000137</td>
      <td>0.000222</td>
      <td>0.000122</td>
      <td>6.535571e-05</td>
      <td>0.001905</td>
      <td>0.000346</td>
      <td>0.000142</td>
      <td>0.000231</td>
      <td>0.000126</td>
      <td>0.000068</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.271561</td>
      <td>0.002096</td>
      <td>0.000820</td>
      <td>1.009114</td>
      <td>0.057339</td>
      <td>0.000515</td>
      <td>0.006717</td>
      <td>0.000285</td>
      <td>0</td>
      <td>0.000604</td>
      <td>...</td>
      <td>0.000191</td>
      <td>0.000270</td>
      <td>0.000138</td>
      <td>8.221320e-05</td>
      <td>0.001935</td>
      <td>0.001100</td>
      <td>0.000198</td>
      <td>0.000280</td>
      <td>0.000143</td>
      <td>0.000085</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.006459</td>
      <td>0.003171</td>
      <td>0.004560</td>
      <td>0.005610</td>
      <td>1.083815</td>
      <td>0.001907</td>
      <td>0.013748</td>
      <td>0.001371</td>
      <td>0</td>
      <td>0.003210</td>
      <td>...</td>
      <td>0.000875</td>
      <td>0.001302</td>
      <td>0.000600</td>
      <td>3.550982e-04</td>
      <td>0.011055</td>
      <td>0.001244</td>
      <td>0.000909</td>
      <td>0.001351</td>
      <td>0.000623</td>
      <td>0.000369</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.017214</td>
      <td>0.001380</td>
      <td>0.001754</td>
      <td>0.006918</td>
      <td>0.004537</td>
      <td>1.009796</td>
      <td>0.014923</td>
      <td>0.003683</td>
      <td>0</td>
      <td>0.001286</td>
      <td>...</td>
      <td>0.000267</td>
      <td>0.000572</td>
      <td>0.000347</td>
      <td>1.362379e-04</td>
      <td>0.004232</td>
      <td>0.000649</td>
      <td>0.000277</td>
      <td>0.000594</td>
      <td>0.000360</td>
      <td>0.000141</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.026051</td>
      <td>0.005356</td>
      <td>0.007505</td>
      <td>0.011918</td>
      <td>0.011387</td>
      <td>0.012447</td>
      <td>1.091851</td>
      <td>0.002326</td>
      <td>0</td>
      <td>0.005321</td>
      <td>...</td>
      <td>0.000434</td>
      <td>0.001048</td>
      <td>0.000455</td>
      <td>2.062243e-04</td>
      <td>0.018267</td>
      <td>0.001918</td>
      <td>0.000451</td>
      <td>0.001088</td>
      <td>0.000473</td>
      <td>0.000214</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.001722</td>
      <td>0.001313</td>
      <td>0.001927</td>
      <td>0.000758</td>
      <td>0.001175</td>
      <td>0.000616</td>
      <td>0.000802</td>
      <td>1.066433</td>
      <td>0</td>
      <td>0.001343</td>
      <td>...</td>
      <td>0.000016</td>
      <td>0.000038</td>
      <td>0.000025</td>
      <td>1.569124e-05</td>
      <td>0.004713</td>
      <td>0.000044</td>
      <td>0.000016</td>
      <td>0.000040</td>
      <td>0.000026</td>
      <td>0.000016</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.000901</td>
      <td>0.001139</td>
      <td>0.001703</td>
      <td>0.000271</td>
      <td>0.000877</td>
      <td>0.000535</td>
      <td>0.000683</td>
      <td>0.000488</td>
      <td>1</td>
      <td>0.001172</td>
      <td>...</td>
      <td>0.000010</td>
      <td>0.000024</td>
      <td>0.000020</td>
      <td>6.026703e-06</td>
      <td>0.004166</td>
      <td>0.000138</td>
      <td>0.000011</td>
      <td>0.000025</td>
      <td>0.000021</td>
      <td>0.000006</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.000786</td>
      <td>0.003396</td>
      <td>0.000171</td>
      <td>0.000119</td>
      <td>0.000290</td>
      <td>0.000269</td>
      <td>0.000199</td>
      <td>0.000546</td>
      <td>0</td>
      <td>1.056485</td>
      <td>...</td>
      <td>0.000005</td>
      <td>0.000013</td>
      <td>0.000007</td>
      <td>2.903939e-06</td>
      <td>0.000363</td>
      <td>0.000014</td>
      <td>0.000006</td>
      <td>0.000013</td>
      <td>0.000007</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.000061</td>
      <td>0.000119</td>
      <td>0.000038</td>
      <td>0.000018</td>
      <td>0.000054</td>
      <td>0.000033</td>
      <td>0.000081</td>
      <td>0.000542</td>
      <td>0</td>
      <td>0.001380</td>
      <td>...</td>
      <td>0.000004</td>
      <td>0.000005</td>
      <td>0.000005</td>
      <td>2.901632e-06</td>
      <td>0.000089</td>
      <td>0.000010</td>
      <td>0.000004</td>
      <td>0.000005</td>
      <td>0.000006</td>
      <td>0.000003</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.000110</td>
      <td>0.001020</td>
      <td>0.000017</td>
      <td>0.000033</td>
      <td>0.000034</td>
      <td>0.000065</td>
      <td>0.000033</td>
      <td>0.000101</td>
      <td>0</td>
      <td>0.000530</td>
      <td>...</td>
      <td>0.000001</td>
      <td>0.000002</td>
      <td>0.000002</td>
      <td>9.956247e-07</td>
      <td>0.000020</td>
      <td>0.000003</td>
      <td>0.000001</td>
      <td>0.000002</td>
      <td>0.000002</td>
      <td>0.000001</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.000084</td>
      <td>0.000196</td>
      <td>0.000070</td>
      <td>0.000047</td>
      <td>0.000076</td>
      <td>0.000052</td>
      <td>0.000105</td>
      <td>0.000070</td>
      <td>0</td>
      <td>0.000124</td>
      <td>...</td>
      <td>0.000015</td>
      <td>0.000018</td>
      <td>0.000021</td>
      <td>1.266344e-05</td>
      <td>0.000159</td>
      <td>0.000030</td>
      <td>0.000016</td>
      <td>0.000019</td>
      <td>0.000022</td>
      <td>0.000013</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.003649</td>
      <td>0.000920</td>
      <td>0.000449</td>
      <td>0.000251</td>
      <td>0.001604</td>
      <td>0.000548</td>
      <td>0.000804</td>
      <td>0.000472</td>
      <td>0</td>
      <td>0.002653</td>
      <td>...</td>
      <td>0.000015</td>
      <td>0.000033</td>
      <td>0.000022</td>
      <td>1.207173e-05</td>
      <td>0.001072</td>
      <td>0.000038</td>
      <td>0.000015</td>
      <td>0.000034</td>
      <td>0.000023</td>
      <td>0.000013</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.021319</td>
      <td>0.032809</td>
      <td>0.004830</td>
      <td>0.002345</td>
      <td>0.009574</td>
      <td>0.004901</td>
      <td>0.005007</td>
      <td>0.003542</td>
      <td>0</td>
      <td>0.010209</td>
      <td>...</td>
      <td>0.000171</td>
      <td>0.000302</td>
      <td>0.000219</td>
      <td>1.195468e-04</td>
      <td>0.010802</td>
      <td>0.000771</td>
      <td>0.000178</td>
      <td>0.000313</td>
      <td>0.000227</td>
      <td>0.000124</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.066084</td>
      <td>0.104604</td>
      <td>0.014226</td>
      <td>0.006566</td>
      <td>0.026143</td>
      <td>0.013457</td>
      <td>0.013130</td>
      <td>0.009866</td>
      <td>0</td>
      <td>0.023118</td>
      <td>...</td>
      <td>0.000399</td>
      <td>0.000685</td>
      <td>0.000473</td>
      <td>2.707908e-04</td>
      <td>0.031663</td>
      <td>0.001748</td>
      <td>0.000414</td>
      <td>0.000711</td>
      <td>0.000491</td>
      <td>0.000281</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.000994</td>
      <td>0.001331</td>
      <td>0.000475</td>
      <td>0.000221</td>
      <td>0.000727</td>
      <td>0.000648</td>
      <td>0.001119</td>
      <td>0.001145</td>
      <td>0</td>
      <td>0.001662</td>
      <td>...</td>
      <td>0.000024</td>
      <td>0.000033</td>
      <td>0.000028</td>
      <td>2.336864e-05</td>
      <td>0.001122</td>
      <td>0.000062</td>
      <td>0.000025</td>
      <td>0.000035</td>
      <td>0.000029</td>
      <td>0.000024</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.002877</td>
      <td>0.010425</td>
      <td>0.001137</td>
      <td>0.001491</td>
      <td>0.002210</td>
      <td>0.001511</td>
      <td>0.002165</td>
      <td>0.003287</td>
      <td>0</td>
      <td>0.002824</td>
      <td>...</td>
      <td>0.000132</td>
      <td>0.000148</td>
      <td>0.000143</td>
      <td>1.065146e-04</td>
      <td>0.001922</td>
      <td>0.000223</td>
      <td>0.000137</td>
      <td>0.000153</td>
      <td>0.000148</td>
      <td>0.000111</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.004218</td>
      <td>0.001406</td>
      <td>0.002020</td>
      <td>0.000921</td>
      <td>0.001731</td>
      <td>0.000654</td>
      <td>0.000905</td>
      <td>0.000595</td>
      <td>0</td>
      <td>0.001424</td>
      <td>...</td>
      <td>0.000034</td>
      <td>0.000070</td>
      <td>0.000076</td>
      <td>2.257031e-05</td>
      <td>0.004933</td>
      <td>0.000172</td>
      <td>0.000035</td>
      <td>0.000072</td>
      <td>0.000079</td>
      <td>0.000023</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.005011</td>
      <td>0.060440</td>
      <td>0.000493</td>
      <td>0.001468</td>
      <td>0.001144</td>
      <td>0.003428</td>
      <td>0.000961</td>
      <td>0.000940</td>
      <td>0</td>
      <td>0.000096</td>
      <td>...</td>
      <td>0.000017</td>
      <td>0.000022</td>
      <td>0.000018</td>
      <td>1.117224e-05</td>
      <td>0.000219</td>
      <td>0.000028</td>
      <td>0.000018</td>
      <td>0.000023</td>
      <td>0.000018</td>
      <td>0.000012</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.011293</td>
      <td>0.050822</td>
      <td>0.002511</td>
      <td>0.002373</td>
      <td>0.008065</td>
      <td>0.005273</td>
      <td>0.007144</td>
      <td>0.003959</td>
      <td>0</td>
      <td>0.004188</td>
      <td>...</td>
      <td>0.000262</td>
      <td>0.000294</td>
      <td>0.000352</td>
      <td>2.142539e-04</td>
      <td>0.004914</td>
      <td>0.000477</td>
      <td>0.000272</td>
      <td>0.000305</td>
      <td>0.000366</td>
      <td>0.000223</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.003485</td>
      <td>0.005876</td>
      <td>0.001938</td>
      <td>0.001979</td>
      <td>0.018338</td>
      <td>0.006683</td>
      <td>0.012544</td>
      <td>0.007879</td>
      <td>0</td>
      <td>0.010264</td>
      <td>...</td>
      <td>0.000135</td>
      <td>0.000224</td>
      <td>0.000141</td>
      <td>8.641271e-05</td>
      <td>0.004573</td>
      <td>0.000336</td>
      <td>0.000140</td>
      <td>0.000232</td>
      <td>0.000147</td>
      <td>0.000090</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.000540</td>
      <td>0.000567</td>
      <td>0.000241</td>
      <td>0.000181</td>
      <td>0.000496</td>
      <td>0.000439</td>
      <td>0.000713</td>
      <td>0.002049</td>
      <td>0</td>
      <td>0.000392</td>
      <td>...</td>
      <td>0.000041</td>
      <td>0.000063</td>
      <td>0.000043</td>
      <td>2.844977e-05</td>
      <td>0.000563</td>
      <td>0.000076</td>
      <td>0.000043</td>
      <td>0.000066</td>
      <td>0.000045</td>
      <td>0.000030</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.000712</td>
      <td>0.000974</td>
      <td>0.000477</td>
      <td>0.000184</td>
      <td>0.000572</td>
      <td>0.000322</td>
      <td>0.000431</td>
      <td>0.012376</td>
      <td>0</td>
      <td>0.000752</td>
      <td>...</td>
      <td>0.000023</td>
      <td>0.000048</td>
      <td>0.000032</td>
      <td>1.525851e-05</td>
      <td>0.001130</td>
      <td>0.000059</td>
      <td>0.000024</td>
      <td>0.000050</td>
      <td>0.000033</td>
      <td>0.000016</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.000960</td>
      <td>0.000812</td>
      <td>0.000685</td>
      <td>0.000940</td>
      <td>0.005338</td>
      <td>0.002220</td>
      <td>0.004053</td>
      <td>0.002612</td>
      <td>0</td>
      <td>0.001279</td>
      <td>...</td>
      <td>0.000140</td>
      <td>0.000178</td>
      <td>0.000114</td>
      <td>8.575875e-05</td>
      <td>0.001640</td>
      <td>0.000330</td>
      <td>0.000146</td>
      <td>0.000184</td>
      <td>0.000118</td>
      <td>0.000089</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.002523</td>
      <td>0.001584</td>
      <td>0.001081</td>
      <td>0.002875</td>
      <td>0.019120</td>
      <td>0.006195</td>
      <td>0.015281</td>
      <td>0.009841</td>
      <td>0</td>
      <td>0.001564</td>
      <td>...</td>
      <td>0.000141</td>
      <td>0.000178</td>
      <td>0.000123</td>
      <td>7.032236e-05</td>
      <td>0.002593</td>
      <td>0.000418</td>
      <td>0.000146</td>
      <td>0.000185</td>
      <td>0.000128</td>
      <td>0.000073</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.001244</td>
      <td>0.001350</td>
      <td>0.000894</td>
      <td>0.000333</td>
      <td>0.001548</td>
      <td>0.000710</td>
      <td>0.001240</td>
      <td>0.000810</td>
      <td>0</td>
      <td>0.001941</td>
      <td>...</td>
      <td>0.000028</td>
      <td>0.000054</td>
      <td>0.000040</td>
      <td>1.588696e-05</td>
      <td>0.002156</td>
      <td>0.000121</td>
      <td>0.000029</td>
      <td>0.000056</td>
      <td>0.000042</td>
      <td>0.000017</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.000576</td>
      <td>0.001092</td>
      <td>0.000589</td>
      <td>0.000331</td>
      <td>0.000680</td>
      <td>0.000841</td>
      <td>0.000513</td>
      <td>0.000382</td>
      <td>0</td>
      <td>0.001483</td>
      <td>...</td>
      <td>0.000043</td>
      <td>0.000084</td>
      <td>0.000067</td>
      <td>3.769068e-05</td>
      <td>0.001412</td>
      <td>0.000056</td>
      <td>0.000045</td>
      <td>0.000087</td>
      <td>0.000069</td>
      <td>0.000039</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.000997</td>
      <td>0.001607</td>
      <td>0.000758</td>
      <td>0.000260</td>
      <td>0.000881</td>
      <td>0.000527</td>
      <td>0.002096</td>
      <td>0.019761</td>
      <td>0</td>
      <td>0.001517</td>
      <td>...</td>
      <td>0.000029</td>
      <td>0.000051</td>
      <td>0.000041</td>
      <td>2.039202e-05</td>
      <td>0.001808</td>
      <td>0.000098</td>
      <td>0.000030</td>
      <td>0.000053</td>
      <td>0.000043</td>
      <td>0.000021</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.001636</td>
      <td>0.002029</td>
      <td>0.000590</td>
      <td>0.001029</td>
      <td>0.001423</td>
      <td>0.000779</td>
      <td>0.006463</td>
      <td>0.002142</td>
      <td>0</td>
      <td>0.006223</td>
      <td>...</td>
      <td>0.000141</td>
      <td>0.000181</td>
      <td>0.000162</td>
      <td>1.004711e-04</td>
      <td>0.001347</td>
      <td>0.000373</td>
      <td>0.000146</td>
      <td>0.000188</td>
      <td>0.000168</td>
      <td>0.000104</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>522</th>
      <td>0.003792</td>
      <td>0.002830</td>
      <td>0.002936</td>
      <td>0.004255</td>
      <td>0.005317</td>
      <td>0.006892</td>
      <td>0.006459</td>
      <td>0.002196</td>
      <td>0</td>
      <td>0.002445</td>
      <td>...</td>
      <td>0.004292</td>
      <td>0.005073</td>
      <td>0.008899</td>
      <td>2.346608e-02</td>
      <td>0.005082</td>
      <td>0.004695</td>
      <td>0.004458</td>
      <td>0.005264</td>
      <td>0.009242</td>
      <td>0.024372</td>
    </tr>
    <tr>
      <th>523</th>
      <td>0.004890</td>
      <td>0.004284</td>
      <td>0.004598</td>
      <td>0.004872</td>
      <td>0.006872</td>
      <td>0.007225</td>
      <td>0.006766</td>
      <td>0.002796</td>
      <td>0</td>
      <td>0.004206</td>
      <td>...</td>
      <td>0.008313</td>
      <td>0.007043</td>
      <td>0.006683</td>
      <td>1.383806e-02</td>
      <td>0.009385</td>
      <td>0.007999</td>
      <td>0.008634</td>
      <td>0.007309</td>
      <td>0.006940</td>
      <td>0.014372</td>
    </tr>
    <tr>
      <th>524</th>
      <td>0.000765</td>
      <td>0.000699</td>
      <td>0.000878</td>
      <td>0.000679</td>
      <td>0.000944</td>
      <td>0.001031</td>
      <td>0.001017</td>
      <td>0.000423</td>
      <td>0</td>
      <td>0.000668</td>
      <td>...</td>
      <td>0.001229</td>
      <td>0.001052</td>
      <td>0.000968</td>
      <td>2.908885e-03</td>
      <td>0.001861</td>
      <td>0.001347</td>
      <td>0.001277</td>
      <td>0.001092</td>
      <td>0.001006</td>
      <td>0.003021</td>
    </tr>
    <tr>
      <th>525</th>
      <td>0.004617</td>
      <td>0.004027</td>
      <td>0.004790</td>
      <td>0.004280</td>
      <td>0.006067</td>
      <td>0.006892</td>
      <td>0.006670</td>
      <td>0.002618</td>
      <td>0</td>
      <td>0.003751</td>
      <td>...</td>
      <td>0.005812</td>
      <td>0.004905</td>
      <td>0.008106</td>
      <td>1.983040e-02</td>
      <td>0.009803</td>
      <td>0.006089</td>
      <td>0.006036</td>
      <td>0.005090</td>
      <td>0.008418</td>
      <td>0.020596</td>
    </tr>
    <tr>
      <th>526</th>
      <td>0.007478</td>
      <td>0.006816</td>
      <td>0.007899</td>
      <td>0.007468</td>
      <td>0.009825</td>
      <td>0.010063</td>
      <td>0.009627</td>
      <td>0.004166</td>
      <td>0</td>
      <td>0.006449</td>
      <td>...</td>
      <td>0.015440</td>
      <td>0.015317</td>
      <td>0.015453</td>
      <td>1.860017e-02</td>
      <td>0.016362</td>
      <td>0.015437</td>
      <td>0.016035</td>
      <td>0.015894</td>
      <td>0.016048</td>
      <td>0.019318</td>
    </tr>
    <tr>
      <th>527</th>
      <td>0.017266</td>
      <td>0.013224</td>
      <td>0.013768</td>
      <td>0.018916</td>
      <td>0.025338</td>
      <td>0.030958</td>
      <td>0.028219</td>
      <td>0.009685</td>
      <td>0</td>
      <td>0.011878</td>
      <td>...</td>
      <td>0.018762</td>
      <td>0.018067</td>
      <td>0.015978</td>
      <td>8.820766e-02</td>
      <td>0.025210</td>
      <td>0.015946</td>
      <td>0.019486</td>
      <td>0.018747</td>
      <td>0.016594</td>
      <td>0.091612</td>
    </tr>
    <tr>
      <th>528</th>
      <td>0.006069</td>
      <td>0.004536</td>
      <td>0.004287</td>
      <td>0.007306</td>
      <td>0.009508</td>
      <td>0.012076</td>
      <td>0.010602</td>
      <td>0.003582</td>
      <td>0</td>
      <td>0.003925</td>
      <td>...</td>
      <td>0.006484</td>
      <td>0.006590</td>
      <td>0.005583</td>
      <td>2.093204e-02</td>
      <td>0.007631</td>
      <td>0.005720</td>
      <td>0.006734</td>
      <td>0.006838</td>
      <td>0.005798</td>
      <td>0.021740</td>
    </tr>
    <tr>
      <th>529</th>
      <td>0.005260</td>
      <td>0.004478</td>
      <td>0.005358</td>
      <td>0.005055</td>
      <td>0.006754</td>
      <td>0.007982</td>
      <td>0.007546</td>
      <td>0.002910</td>
      <td>0</td>
      <td>0.004230</td>
      <td>...</td>
      <td>0.007365</td>
      <td>0.006421</td>
      <td>0.004086</td>
      <td>2.371863e-02</td>
      <td>0.010927</td>
      <td>0.006395</td>
      <td>0.007649</td>
      <td>0.006663</td>
      <td>0.004243</td>
      <td>0.024634</td>
    </tr>
    <tr>
      <th>530</th>
      <td>0.008304</td>
      <td>0.006863</td>
      <td>0.007755</td>
      <td>0.008718</td>
      <td>0.011379</td>
      <td>0.013128</td>
      <td>0.012342</td>
      <td>0.004567</td>
      <td>0</td>
      <td>0.006097</td>
      <td>...</td>
      <td>0.013242</td>
      <td>0.013648</td>
      <td>0.012276</td>
      <td>3.577460e-02</td>
      <td>0.014328</td>
      <td>0.011847</td>
      <td>0.013753</td>
      <td>0.014162</td>
      <td>0.012749</td>
      <td>0.037155</td>
    </tr>
    <tr>
      <th>531</th>
      <td>0.000348</td>
      <td>0.000252</td>
      <td>0.000271</td>
      <td>0.000402</td>
      <td>0.000475</td>
      <td>0.000621</td>
      <td>0.000572</td>
      <td>0.000191</td>
      <td>0</td>
      <td>0.000221</td>
      <td>...</td>
      <td>0.000660</td>
      <td>0.000572</td>
      <td>0.000307</td>
      <td>2.139143e-03</td>
      <td>0.000478</td>
      <td>0.000322</td>
      <td>0.000685</td>
      <td>0.000594</td>
      <td>0.000319</td>
      <td>0.002222</td>
    </tr>
    <tr>
      <th>532</th>
      <td>0.004976</td>
      <td>0.003576</td>
      <td>0.003355</td>
      <td>0.005790</td>
      <td>0.007391</td>
      <td>0.010624</td>
      <td>0.008112</td>
      <td>0.002595</td>
      <td>0</td>
      <td>0.003013</td>
      <td>...</td>
      <td>0.004542</td>
      <td>0.004430</td>
      <td>0.004047</td>
      <td>1.268942e-02</td>
      <td>0.005337</td>
      <td>0.004072</td>
      <td>0.004717</td>
      <td>0.004597</td>
      <td>0.004203</td>
      <td>0.013179</td>
    </tr>
    <tr>
      <th>533</th>
      <td>0.003733</td>
      <td>0.002523</td>
      <td>0.002069</td>
      <td>0.004909</td>
      <td>0.003853</td>
      <td>0.005964</td>
      <td>0.003961</td>
      <td>0.002237</td>
      <td>0</td>
      <td>0.002325</td>
      <td>...</td>
      <td>0.003497</td>
      <td>0.003356</td>
      <td>0.002897</td>
      <td>5.630594e-03</td>
      <td>0.003951</td>
      <td>0.003253</td>
      <td>0.003632</td>
      <td>0.003482</td>
      <td>0.003008</td>
      <td>0.005848</td>
    </tr>
    <tr>
      <th>534</th>
      <td>0.211105</td>
      <td>0.208128</td>
      <td>0.191150</td>
      <td>0.085573</td>
      <td>0.269038</td>
      <td>0.163948</td>
      <td>0.193643</td>
      <td>0.154669</td>
      <td>0</td>
      <td>0.383858</td>
      <td>...</td>
      <td>0.002373</td>
      <td>0.005684</td>
      <td>0.003820</td>
      <td>1.374736e-03</td>
      <td>0.295193</td>
      <td>0.008851</td>
      <td>0.002465</td>
      <td>0.005898</td>
      <td>0.003967</td>
      <td>0.001428</td>
    </tr>
    <tr>
      <th>535</th>
      <td>0.011677</td>
      <td>0.012597</td>
      <td>0.010758</td>
      <td>0.008988</td>
      <td>0.028580</td>
      <td>0.015028</td>
      <td>0.014126</td>
      <td>0.008351</td>
      <td>0</td>
      <td>0.032360</td>
      <td>...</td>
      <td>0.012752</td>
      <td>0.006085</td>
      <td>0.005481</td>
      <td>1.262157e-03</td>
      <td>0.016914</td>
      <td>0.344659</td>
      <td>0.013244</td>
      <td>0.006314</td>
      <td>0.005692</td>
      <td>0.001311</td>
    </tr>
    <tr>
      <th>536</th>
      <td>0.011838</td>
      <td>0.004383</td>
      <td>0.003639</td>
      <td>0.030775</td>
      <td>0.007856</td>
      <td>0.006554</td>
      <td>0.007217</td>
      <td>0.002922</td>
      <td>0</td>
      <td>0.003343</td>
      <td>...</td>
      <td>0.317130</td>
      <td>0.039845</td>
      <td>0.002454</td>
      <td>1.803673e-03</td>
      <td>0.004913</td>
      <td>0.013991</td>
      <td>0.329365</td>
      <td>0.041345</td>
      <td>0.002549</td>
      <td>0.001873</td>
    </tr>
    <tr>
      <th>537</th>
      <td>0.065828</td>
      <td>0.032158</td>
      <td>0.029004</td>
      <td>0.157128</td>
      <td>0.044234</td>
      <td>0.039952</td>
      <td>0.034783</td>
      <td>0.022565</td>
      <td>0</td>
      <td>0.023088</td>
      <td>...</td>
      <td>0.083380</td>
      <td>0.375494</td>
      <td>0.003766</td>
      <td>4.127731e-03</td>
      <td>0.035545</td>
      <td>0.023047</td>
      <td>0.086597</td>
      <td>0.389628</td>
      <td>0.003911</td>
      <td>0.004287</td>
    </tr>
    <tr>
      <th>538</th>
      <td>0.038281</td>
      <td>0.053775</td>
      <td>0.038690</td>
      <td>0.027266</td>
      <td>0.058400</td>
      <td>0.043947</td>
      <td>0.065661</td>
      <td>0.043195</td>
      <td>0</td>
      <td>0.038277</td>
      <td>...</td>
      <td>0.035561</td>
      <td>0.025397</td>
      <td>0.465560</td>
      <td>1.600859e-02</td>
      <td>0.075721</td>
      <td>0.096947</td>
      <td>0.036933</td>
      <td>0.026353</td>
      <td>0.483502</td>
      <td>0.016626</td>
    </tr>
    <tr>
      <th>539</th>
      <td>0.228363</td>
      <td>0.165972</td>
      <td>0.169113</td>
      <td>0.258242</td>
      <td>0.328479</td>
      <td>0.419359</td>
      <td>0.378294</td>
      <td>0.132603</td>
      <td>0</td>
      <td>0.147138</td>
      <td>...</td>
      <td>0.249567</td>
      <td>0.254007</td>
      <td>0.225730</td>
      <td>6.955669e-01</td>
      <td>0.300664</td>
      <td>0.222912</td>
      <td>0.259195</td>
      <td>0.263568</td>
      <td>0.234429</td>
      <td>0.722412</td>
    </tr>
    <tr>
      <th>540</th>
      <td>0.100878</td>
      <td>0.180909</td>
      <td>0.378850</td>
      <td>0.009940</td>
      <td>0.040547</td>
      <td>0.024720</td>
      <td>0.045924</td>
      <td>0.018371</td>
      <td>0</td>
      <td>0.032603</td>
      <td>...</td>
      <td>0.000471</td>
      <td>0.001125</td>
      <td>0.000649</td>
      <td>2.626350e-04</td>
      <td>0.046405</td>
      <td>0.001568</td>
      <td>0.000489</td>
      <td>0.001168</td>
      <td>0.000674</td>
      <td>0.000273</td>
    </tr>
    <tr>
      <th>541</th>
      <td>0.003775</td>
      <td>0.004751</td>
      <td>0.007274</td>
      <td>0.002479</td>
      <td>0.007231</td>
      <td>0.005639</td>
      <td>0.005169</td>
      <td>0.001742</td>
      <td>0</td>
      <td>0.006694</td>
      <td>...</td>
      <td>0.003134</td>
      <td>0.001520</td>
      <td>0.001256</td>
      <td>2.996093e-04</td>
      <td>0.003580</td>
      <td>0.070142</td>
      <td>0.003255</td>
      <td>0.001578</td>
      <td>0.001304</td>
      <td>0.000311</td>
    </tr>
    <tr>
      <th>542</th>
      <td>0.003258</td>
      <td>0.000945</td>
      <td>0.000893</td>
      <td>0.008916</td>
      <td>0.002076</td>
      <td>0.001793</td>
      <td>0.002246</td>
      <td>0.000594</td>
      <td>0</td>
      <td>0.000612</td>
      <td>...</td>
      <td>1.056336</td>
      <td>0.007008</td>
      <td>0.000518</td>
      <td>3.631151e-04</td>
      <td>0.000924</td>
      <td>0.002611</td>
      <td>0.058510</td>
      <td>0.007272</td>
      <td>0.000538</td>
      <td>0.000377</td>
    </tr>
    <tr>
      <th>543</th>
      <td>0.018416</td>
      <td>0.008788</td>
      <td>0.010877</td>
      <td>0.044880</td>
      <td>0.010196</td>
      <td>0.011482</td>
      <td>0.010704</td>
      <td>0.003983</td>
      <td>0</td>
      <td>0.003805</td>
      <td>...</td>
      <td>0.014494</td>
      <td>1.061179</td>
      <td>0.000691</td>
      <td>7.600705e-04</td>
      <td>0.006202</td>
      <td>0.003567</td>
      <td>0.015054</td>
      <td>0.063482</td>
      <td>0.000717</td>
      <td>0.000789</td>
    </tr>
    <tr>
      <th>544</th>
      <td>0.009879</td>
      <td>0.013433</td>
      <td>0.011772</td>
      <td>0.007372</td>
      <td>0.014777</td>
      <td>0.013533</td>
      <td>0.025508</td>
      <td>0.010255</td>
      <td>0</td>
      <td>0.008249</td>
      <td>...</td>
      <td>0.009673</td>
      <td>0.006821</td>
      <td>1.105398</td>
      <td>3.761450e-03</td>
      <td>0.016770</td>
      <td>0.022484</td>
      <td>0.010046</td>
      <td>0.007078</td>
      <td>0.109460</td>
      <td>0.003907</td>
    </tr>
    <tr>
      <th>545</th>
      <td>0.051082</td>
      <td>0.032565</td>
      <td>0.038714</td>
      <td>0.058126</td>
      <td>0.068261</td>
      <td>0.109981</td>
      <td>0.105942</td>
      <td>0.024251</td>
      <td>0</td>
      <td>0.026011</td>
      <td>...</td>
      <td>0.045840</td>
      <td>0.045807</td>
      <td>0.038454</td>
      <td>1.117040e+00</td>
      <td>0.053694</td>
      <td>0.040015</td>
      <td>0.047609</td>
      <td>0.047531</td>
      <td>0.039936</td>
      <td>0.121557</td>
    </tr>
    <tr>
      <th>546</th>
      <td>0.285034</td>
      <td>0.360750</td>
      <td>0.539536</td>
      <td>0.085242</td>
      <td>0.277095</td>
      <td>0.168869</td>
      <td>0.215830</td>
      <td>0.154465</td>
      <td>0</td>
      <td>0.370638</td>
      <td>...</td>
      <td>0.002555</td>
      <td>0.006117</td>
      <td>0.004006</td>
      <td>1.470187e-03</td>
      <td>1.320183</td>
      <td>0.009345</td>
      <td>0.002654</td>
      <td>0.006348</td>
      <td>0.004160</td>
      <td>0.001527</td>
    </tr>
    <tr>
      <th>547</th>
      <td>0.013828</td>
      <td>0.015580</td>
      <td>0.016450</td>
      <td>0.010226</td>
      <td>0.031881</td>
      <td>0.018559</td>
      <td>0.017317</td>
      <td>0.008953</td>
      <td>0</td>
      <td>0.034637</td>
      <td>...</td>
      <td>0.014134</td>
      <td>0.006769</td>
      <td>0.005986</td>
      <td>1.388626e-03</td>
      <td>0.018184</td>
      <td>1.381674</td>
      <td>0.014680</td>
      <td>0.007024</td>
      <td>0.006216</td>
      <td>0.001442</td>
    </tr>
    <tr>
      <th>548</th>
      <td>0.013721</td>
      <td>0.004824</td>
      <td>0.004111</td>
      <td>0.036106</td>
      <td>0.009021</td>
      <td>0.007585</td>
      <td>0.008619</td>
      <td>0.003181</td>
      <td>0</td>
      <td>0.003573</td>
      <td>...</td>
      <td>1.315340</td>
      <td>0.042311</td>
      <td>0.002691</td>
      <td>1.960161e-03</td>
      <td>0.005275</td>
      <td>0.015003</td>
      <td>1.366086</td>
      <td>0.043904</td>
      <td>0.002795</td>
      <td>0.002036</td>
    </tr>
    <tr>
      <th>549</th>
      <td>0.076045</td>
      <td>0.036945</td>
      <td>0.036205</td>
      <td>0.182416</td>
      <td>0.048971</td>
      <td>0.046451</td>
      <td>0.041132</td>
      <td>0.023791</td>
      <td>0</td>
      <td>0.024078</td>
      <td>...</td>
      <td>0.087693</td>
      <td>1.367859</td>
      <td>0.003996</td>
      <td>4.382780e-03</td>
      <td>0.037406</td>
      <td>0.023810</td>
      <td>0.091076</td>
      <td>1.419345</td>
      <td>0.004150</td>
      <td>0.004552</td>
    </tr>
    <tr>
      <th>550</th>
      <td>0.044408</td>
      <td>0.061948</td>
      <td>0.046626</td>
      <td>0.031957</td>
      <td>0.067460</td>
      <td>0.053120</td>
      <td>0.084525</td>
      <td>0.049238</td>
      <td>0</td>
      <td>0.042813</td>
      <td>...</td>
      <td>0.041737</td>
      <td>0.029722</td>
      <td>1.501278</td>
      <td>1.821000e-02</td>
      <td>0.085138</td>
      <td>0.109991</td>
      <td>0.043347</td>
      <td>0.030841</td>
      <td>1.559135</td>
      <td>0.018913</td>
    </tr>
    <tr>
      <th>551</th>
      <td>0.254977</td>
      <td>0.180854</td>
      <td>0.189688</td>
      <td>0.288692</td>
      <td>0.361659</td>
      <td>0.484055</td>
      <td>0.443238</td>
      <td>0.142765</td>
      <td>0</td>
      <td>0.157535</td>
      <td>...</td>
      <td>0.268886</td>
      <td>0.272840</td>
      <td>0.240261</td>
      <td>1.717049e+00</td>
      <td>0.322440</td>
      <td>0.239259</td>
      <td>0.279260</td>
      <td>0.283110</td>
      <td>0.249521</td>
      <td>1.783319</td>
    </tr>
  </tbody>
</table>
<p>552 rows Ã— 552 columns</p>
</div>



## Get the Change in Industry Demand

### extract the first data column (sales) from the users data (Industry spending) 


```python
#IndustrySpending
IndustrySpending = pd.read_excel(new_MRIO,'region0', usecols = "C")
```

### multiply it against the MRSAM_mult multipliers


```python
IndustryOutput = np.matmul(mrsam_mult_df,IndustrySpending)
IndustryOutput
```




    array([[  2.41337005e+09],
           [  1.37289862e+09],
           [  6.57417105e+09],
           [  1.36317602e+09],
           [  6.17539706e+09],
           [  1.01885896e+10],
           [  2.66891287e+10],
           [  1.38736657e+10],
           [  8.56466157e+09],
           [  7.76391829e+07],
           [  3.42519227e+07],
           [  1.10941651e+07],
           [  7.77848617e+07],
           [  1.86482219e+08],
           [  2.66919132e+10],
           [  1.14166827e+11],
           [  2.70608550e+09],
           [  1.28692542e+09],
           [  2.73139174e+08],
           [  1.18600826e+08],
           [  2.17183711e+09],
           [  2.36061849e+09],
           [  5.44715068e+08],
           [  4.14482559e+08],
           [  6.06394840e+08],
           [  1.15442020e+09],
           [  4.47845473e+08],
           [  2.39489560e+08],
           [  7.69438257e+08],
           [  1.18691658e+09],
           [  2.61618637e+09],
           [  8.65154042e+08],
           [  3.92816970e+09],
           [  3.08850768e+09],
           [  4.02687316e+07],
           [  1.37128741e+08],
           [  4.35026005e+08],
           [  2.26458357e+10],
           [  4.67268006e+07],
           [  1.03877554e+08],
           [  5.15228922e+07],
           [  5.14989269e+09],
           [  1.71697847e+09],
           [  7.17309756e+06],
           [  6.08376145e+09],
           [  6.26686497e+09],
           [  3.53773072e+08],
           [  6.59393539e+08],
           [  1.79206394e+08],
           [  2.08747804e+09],
           [  1.25108124e+08],
           [  1.18458506e+09],
           [  3.73436401e+08],
           [  6.47833308e+08],
           [  3.97225107e+08],
           [  3.60001718e+08],
           [  4.68417752e+09],
           [  2.69297336e+08],
           [  4.29979157e+08],
           [  2.65038194e+09],
           [  3.45350703e+08],
           [  1.58437559e+08],
           [  4.29240864e+09],
           [  1.77355507e+09],
           [  3.07460481e+09],
           [  4.21201134e+08],
           [  1.27615135e+10],
           [  8.53997298e+08],
           [  7.88976405e+08],
           [  7.60321639e+09],
           [  3.70659484e+09],
           [  3.34765847e+09],
           [  5.91134051e+08],
           [  1.55054929e+09],
           [  4.33571505e+09],
           [  4.17783130e+09],
           [  1.12637571e+09],
           [  8.81559350e+08],
           [  9.48664943e+08],
           [  5.60051724e+07],
           [  8.69777007e+09],
           [  9.91581666e+09],
           [  5.40982448e+10],
           [  6.60649168e+09],
           [  7.22923613e+08],
           [  1.09368959e+09],
           [  5.76229106e+07],
           [  8.28089873e+08],
           [  2.27507697e+08],
           [  7.54723628e+08],
           [  2.72353460e+08],
           [  3.68072771e+08],
           [  1.00598658e+08],
           [  4.28113823e+08],
           [  2.33094332e+08],
           [  7.12566257e+08],
           [  1.28670170e+08],
           [  4.88841797e+07],
           [  3.21897523e+07],
           [  3.07182856e+07],
           [  1.08620280e+07],
           [  4.93490259e+07],
           [  1.09240321e+08],
           [  4.61189265e+09],
           [  3.16911216e+09],
           [  2.01127445e+08],
           [  3.93355986e+08],
           [  2.67893005e+08],
           [  7.86910673e+07],
           [  8.52339124e+08],
           [  4.38198170e+08],
           [  8.12893848e+07],
           [  7.40547122e+07],
           [  3.14317116e+08],
           [  2.02745311e+08],
           [  9.60096695e+07],
           [  7.12220304e+07],
           [  1.83748526e+08],
           [  6.15019258e+08],
           [  7.06186382e+08],
           [  2.50648743e+08],
           [  4.37041529e+08],
           [  3.28882275e+08],
           [  1.56429460e+07],
           [  5.31835583e+07],
           [  8.19403689e+07],
           [  5.40678840e+07],
           [  3.44784511e+07],
           [  3.37199942e+07],
           [  1.86184346e+08],
           [  1.53318913e+09],
           [  1.06931174e+09],
           [  2.31806286e+06],
           [  1.40445618e+09],
           [  1.82956752e+09],
           [  3.37033326e+08],
           [  2.10969516e+08],
           [  2.42378638e+07],
           [  5.09312246e+08],
           [  5.13711593e+07],
           [  3.05846751e+08],
           [  9.98797569e+07],
           [  1.06200363e+08],
           [  1.34779945e+08],
           [  1.09710570e+08],
           [  1.82378044e+08],
           [  7.68258839e+07],
           [  1.71808747e+08],
           [  1.05658406e+09],
           [  8.22623945e+07],
           [  4.79920511e+07],
           [  1.58155605e+09],
           [  7.08768974e+08],
           [  8.70059551e+08],
           [  8.21002879e+07],
           [  3.05367555e+09],
           [  3.78540845e+08],
           [  6.68883275e+08],
           [  2.45311645e+09],
           [  1.04819593e+09],
           [  1.02994346e+09],
           [  1.53859016e+08],
           [  3.16342836e+08],
           [  1.21730145e+09],
           [  1.01149130e+09],
           [  2.38813195e+08],
           [  1.72228420e+08],
           [  1.25845917e+08],
           [  1.57180581e+07],
           [  1.50174742e+08],
           [  1.37353154e+08],
           [  9.98717010e+08],
           [  3.38627450e+08],
           [  2.02523414e+08],
           [  3.38952131e+08],
           [  2.15107513e+07],
           [  2.37210488e+08],
           [  1.23101065e+08],
           [  4.15494374e+08],
           [  2.04939977e+08],
           [  3.27102230e+08],
           [  1.24845151e+08],
           [  1.19884595e+08],
           [  1.86788954e+08],
           [  5.52760914e+08],
           [  4.13418189e+07],
           [  4.04191736e+07],
           [  1.52954892e+07],
           [  1.87527538e+07],
           [  4.78533905e+06],
           [  0.00000000e+00],
           [  4.25790951e+07],
           [  5.20957493e+08],
           [  1.03572863e+09],
           [  6.27754028e+07],
           [  3.22475389e+08],
           [  9.24338627e+07],
           [  5.48291722e+07],
           [  4.62871593e+08],
           [  2.28377666e+08],
           [  2.21459463e+07],
           [  3.62448152e+07],
           [  1.29519965e+08],
           [  1.19591165e+08],
           [  8.77121542e+07],
           [  2.10254591e+08],
           [  7.82589784e+07],
           [  1.66032760e+08],
           [  2.98491998e+08],
           [  1.01915934e+08],
           [  3.25120926e+08],
           [  2.44032251e+08],
           [  7.94557242e+07],
           [  5.42327716e+07],
           [  4.74425593e+07],
           [  2.43654120e+07],
           [  3.45623772e+07],
           [  4.03943582e+07],
           [  8.97080019e+07],
           [  6.07255833e+08],
           [  5.17713973e+08],
           [  2.73184458e+06],
           [  7.10931677e+08],
           [  7.81031583e+08],
           [  3.84895003e+07],
           [  1.04846177e+08],
           [  1.70072059e+07],
           [  2.44279065e+08],
           [  2.46203715e+07],
           [  6.59679904e+07],
           [  9.85176197e+06],
           [  4.78662255e+07],
           [  7.11547762e+07],
           [  5.89011241e+07],
           [  1.16131223e+08],
           [  3.94530625e+07],
           [  6.37302951e+07],
           [  6.09902504e+08],
           [  4.94847444e+07],
           [  2.46664540e+07],
           [  7.58152515e+08],
           [  4.10910982e+08],
           [  5.62007615e+08],
           [  6.56146601e+07],
           [  1.45351803e+09],
           [  1.34226766e+08],
           [  3.28529729e+08],
           [  1.21892239e+09],
           [  4.71247514e+08],
           [  5.12083420e+08],
           [  7.38249018e+07],
           [  1.79869675e+08],
           [  5.74449676e+08],
           [  5.06584490e+08],
           [  1.66350221e+08],
           [  1.10815733e+08],
           [  5.57836051e+07],
           [  6.29645095e+06],
           [  6.58494579e+07],
           [  7.57364591e+07],
           [  4.16844764e+08],
           [  1.52269480e+08],
           [  9.17876684e+07],
           [  1.55518563e+08],
           [  6.23181296e+06],
           [  1.10824911e+08],
           [  6.26795628e+07],
           [  1.19393314e+09],
           [  1.28412842e+09],
           [  1.27872584e+09],
           [  6.53945014e+08],
           [  6.25334007e+08],
           [  8.18466171e+08],
           [  2.29873143e+09],
           [  4.77181910e+08],
           [  8.58805871e+07],
           [  9.63936695e+07],
           [  2.70698834e+07],
           [  5.01780223e+06],
           [  1.30097059e+08],
           [  1.63358262e+08],
           [  1.01848329e+10],
           [  5.04944159e+09],
           [  6.65314253e+08],
           [  2.17535462e+09],
           [  4.79749664e+08],
           [  2.11830222e+08],
           [  1.68501940e+09],
           [  9.62161942e+08],
           [  1.38429652e+08],
           [  2.03357239e+08],
           [  4.78319090e+08],
           [  6.01806985e+08],
           [  3.26096939e+08],
           [  1.24360207e+08],
           [  4.43768643e+08],
           [  8.28599453e+08],
           [  1.64482479e+09],
           [  4.30665713e+08],
           [  9.55874444e+08],
           [  7.52525049e+08],
           [  7.14131991e+07],
           [  1.10856252e+08],
           [  1.91490233e+08],
           [  2.10382225e+08],
           [  2.82527705e+08],
           [  1.50987270e+08],
           [  5.71351253e+08],
           [  2.91238253e+09],
           [  3.41625019e+09],
           [  1.73700025e+07],
           [  3.38945389e+09],
           [  3.88303674e+09],
           [  2.52321049e+08],
           [  5.07758538e+08],
           [  1.45712222e+08],
           [  1.19059220e+09],
           [  1.90882476e+08],
           [  5.47004691e+08],
           [  1.77344947e+08],
           [  2.59774190e+08],
           [  3.35548709e+08],
           [  2.57722919e+08],
           [  6.19890934e+08],
           [  2.28557571e+08],
           [  6.23913013e+08],
           [  2.57963088e+09],
           [  8.33363944e+08],
           [  1.06288932e+08],
           [  3.89262154e+09],
           [  2.21231575e+09],
           [  3.38884632e+09],
           [  4.72911795e+08],
           [  7.62565379e+09],
           [  6.94713348e+08],
           [  2.46184325e+09],
           [  6.57331484e+09],
           [  2.66020094e+09],
           [  2.63430775e+09],
           [  3.53471728e+08],
           [  9.96612418e+08],
           [  2.47112519e+09],
           [  2.75341666e+09],
           [  6.81210269e+08],
           [  4.23675059e+08],
           [  4.59655698e+08],
           [  4.69402674e+07],
           [  5.75361046e+08],
           [  3.45014342e+08],
           [  2.15472576e+09],
           [  7.62806864e+08],
           [  4.82774756e+08],
           [  8.76505084e+08],
           [  3.08365871e+07],
           [  5.59199760e+08],
           [  3.19038316e+08],
           [  2.47752045e+09],
           [  7.95172902e+08],
           [  1.89917788e+09],
           [  2.73976246e+08],
           [  1.63702035e+09],
           [  1.33678996e+09],
           [  4.62413283e+09],
           [  9.29552295e+08],
           [  3.00574306e+08],
           [  1.83556250e+08],
           [  8.14744868e+07],
           [  3.92305091e+07],
           [  3.21157987e+08],
           [  4.29297901e+08],
           [  7.27721140e+09],
           [  1.28729351e+10],
           [  6.97007475e+08],
           [  1.19130944e+10],
           [  1.12998217e+09],
           [  4.30979937e+08],
           [  1.75077598e+09],
           [  2.54644994e+09],
           [  3.50952008e+08],
           [  5.76187629e+08],
           [  8.40805310e+08],
           [  1.29289469e+09],
           [  5.90750127e+08],
           [  4.03208226e+08],
           [  1.19970556e+09],
           [  3.39123816e+09],
           [  4.95783519e+09],
           [  1.47808477e+09],
           [  3.32212055e+09],
           [  4.29439214e+09],
           [  1.23307388e+08],
           [  3.10332611e+08],
           [  6.55355952e+08],
           [  6.27833659e+08],
           [  3.10790118e+08],
           [  1.60944832e+08],
           [  1.74096012e+09],
           [  7.45184389e+09],
           [  8.72051452e+09],
           [  2.83097238e+07],
           [  9.40135113e+09],
           [  1.06422466e+10],
           [  1.72111684e+09],
           [  9.35802171e+08],
           [  2.69493077e+08],
           [  2.72312182e+09],
           [  3.70670632e+08],
           [  7.84706118e+08],
           [  4.62184611e+08],
           [  6.30467922e+08],
           [  8.79924244e+08],
           [  6.65471727e+08],
           [  1.01604532e+09],
           [  5.23732549e+08],
           [  7.59878594e+08],
           [  5.82023021e+09],
           [  1.02378808e+09],
           [  3.00804531e+08],
           [  1.04930183e+10],
           [  7.66574102e+09],
           [  6.83882449e+09],
           [  2.50481914e+09],
           [  2.32102829e+10],
           [  1.86983354e+09],
           [  6.40585428e+09],
           [  1.73910351e+10],
           [  6.54855506e+09],
           [  6.72631298e+09],
           [  1.01544586e+09],
           [  2.20676532e+09],
           [  7.67056253e+09],
           [  5.78311416e+09],
           [  1.23724509e+09],
           [  9.06358896e+08],
           [  8.86314300e+08],
           [  1.23122623e+08],
           [  7.87255011e+08],
           [  9.77135827e+08],
           [  6.16163699e+09],
           [  2.10687223e+09],
           [  1.44135623e+09],
           [  2.05025807e+09],
           [  1.51500041e+08],
           [  1.22928982e+09],
           [  9.07180686e+08],
           [  1.41136221e+10],
           [  8.51549925e+09],
           [  1.04322081e+10],
           [  4.47523663e+09],
           [  8.28428726e+09],
           [  9.78164475e+09],
           [  2.60579601e+10],
           [  2.96616137e+09],
           [  1.55008679e+09],
           [  5.11967476e+08],
           [  2.44401368e+08],
           [  2.44812589e+08],
           [  1.98076420e+09],
           [  1.52182305e+09],
           [  1.98929671e+10],
           [  3.93278912e+10],
           [  2.30551095e+09],
           [  1.63101572e+10],
           [  1.13620610e+10],
           [  1.65836499e+09],
           [  2.01010277e+10],
           [  1.05618202e+10],
           [  2.26014192e+09],
           [  1.87803174e+09],
           [  6.75829730e+09],
           [  7.06069553e+09],
           [  4.61928888e+09],
           [  3.49385937e+09],
           [  3.52677884e+09],
           [  1.58538302e+10],
           [  1.55180319e+10],
           [  4.16434944e+09],
           [  1.82893885e+10],
           [  1.04857622e+10],
           [  7.25188378e+08],
           [  2.38962821e+09],
           [  2.92832847e+09],
           [  4.00403309e+09],
           [  1.29468592e+09],
           [  1.10060285e+09],
           [  1.50564650e+09],
           [  2.71447024e+10],
           [  1.49794105e+10],
           [  2.91479591e+08],
           [  3.45667736e+10],
           [  4.11215324e+10],
           [  4.30680214e+09],
           [  4.41527979e+09],
           [  1.57645915e+09],
           [  1.16227682e+10],
           [  1.92888791e+09],
           [  1.90989425e+09],
           [  2.73888554e+09],
           [  2.85082263e+09],
           [  3.91962697e+09],
           [  3.00914683e+09],
           [  1.13201054e+10],
           [  4.75044431e+09],
           [  8.93370598e+09],
           [  2.28708809e+10],
           [  3.83957879e+09],
           [  2.97602174e+09],
           [  3.79303412e+10],
           [  2.83516088e+10],
           [  3.00477170e+10],
           [  5.54915751e+09],
           [  8.83860254e+10],
           [  5.75303919e+09],
           [  7.72991779e+09],
           [  5.90961576e+10],
           [  2.32637255e+10],
           [  3.03782170e+10],
           [  4.73012041e+09],
           [  1.36570842e+10],
           [  3.05242810e+10],
           [  2.81074125e+10],
           [  7.00321121e+09],
           [  5.19193075e+09],
           [  6.26943308e+09],
           [  7.78299132e+08],
           [  5.24334700e+09],
           [  7.84988587e+09],
           [  2.34216927e+10],
           [  7.94603748e+09],
           [  6.14394894e+09],
           [  9.95643125e+09],
           [  4.51539357e+08],
           [  5.82222393e+09],
           [  3.57746209e+09],
           [  6.36035979e+10],
           [  1.00887203e+10],
           [  4.92049009e+09],
           [  2.27565735e+10],
           [  6.07695613e+10],
           [  2.61349269e+11],
           [  1.12017886e+10],
           [  2.44203808e+09],
           [  1.04182106e+09],
           [  4.73297685e+09],
           [  1.48115807e+10],
           [  5.06838774e+10],
           [  6.70904568e+10],
           [  1.11457453e+10],
           [  5.39750013e+09],
           [  2.46928107e+10],
           [  6.96461230e+10],
           [  2.84201535e+11]])



### Load the aggregation matrix


```python
#aggregation_matrix = np.loadtxt('aggregation_matrix.txt')
aggregation_matrix = pd.read_excel(ref_mat,'IndAggMat', skiprows=2,  usecols = "C:CM")
aggregation_matrix
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>80</th>
      <th>81</th>
      <th>82</th>
      <th>83</th>
      <th>84</th>
      <th>85</th>
      <th>86</th>
      <th>87</th>
      <th>88</th>
      <th>89</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>14 rows Ã— 89 columns</p>
</div>



### Load the Impact Conversion Factors


```python
impact_conversion_matrix = pd.read_excel(ref_mat,'ConvFact', skiprows=1,  usecols = "O:S")    
```

### Calculate the other values based on the impact conversion factors


```python
sales = []
Employment=[]
Employee_Compensation=[]
Proprietors_Income=[]
Other_Property = []
Indirect_Business_Tax = []

sal = IndustryOutput
for k in range(0,89):
    sales.append(sal[k][0])
    Employment.append(float((sal[k][0] * impact_conversion_matrix['Employment'][k])/1000000))
    Employee_Compensation.append(float((sal[k][0] * impact_conversion_matrix['Employee Compensation'][k])))
    Proprietors_Income.append(float((sal[k][0] * impact_conversion_matrix['Proprietors\' Income'][k])))
    Other_Property.append(float(sal[k][0] * impact_conversion_matrix['Other Property Type Income'][k]))
    Indirect_Business_Tax.append(float(sal[k][0] * impact_conversion_matrix['Indirect Business Tax'][k]))

#sales
```

### now multiply by the aggregation matrix.


```python
aggregated_dict={}
aggregated_dict['Industry']=sector_names
aggregated_dict['Sales'] = np.matmul(aggregation_matrix, sales)
aggregated_dict['Employment'] = np.matmul(aggregation_matrix, Employment)
aggregated_dict['Employee_Compensation'] = np.matmul(aggregation_matrix, Employee_Compensation)
aggregated_dict['Proprietors_Income'] = np.matmul(aggregation_matrix, Proprietors_Income)
aggregated_dict['Other_Property'] = np.matmul(aggregation_matrix, Other_Property)
aggregated_dict['Indirect_Business_Tax'] = np.matmul(aggregation_matrix, Indirect_Business_Tax)
#aggregated_dict        
```

### Calc Value Added and Labor Income and add to output


```python
Value_Added=[]
Labor_Income=[]

for i in range(0,14):
    Value_Added.append(aggregated_dict['Employee_Compensation'][i] + aggregated_dict['Proprietors_Income'][i] + aggregated_dict['Other_Property'][i] + aggregated_dict['Indirect_Business_Tax'][i] )
    Labor_Income.append(aggregated_dict['Employee_Compensation'][i] + aggregated_dict['Proprietors_Income'][i] )
    
aggregated_dict['Value_Added'] = Value_Added
aggregated_dict['Labor_Income'] = Labor_Income    
```

### Build the output.

#### This will write out a spreadsheet to your working directory


```python
cwd = os.chdir(r'C:\Users\jojoseph\Documents\GitHub\reg_soc_acc_mat')
!jupyter-nbconvert regMatrix.ipynb --to markdown
!pandoc regMatrix.md -t docx -o regMatrix.docx
```

    [NbConvertApp] Converting notebook regMatrix.ipynb to markdown
    [NbConvertApp] Writing 62227 bytes to regMatrix.md
    
